<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
 <script src="https://kit.fontawesome.com/19746ffdef.js" crossorigin="anonymous"></script>

 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"> </script>
<title>Daily Mantra Flow</title>
<style>
:root{--bg:#071018;--card:#0f1720;--muted:#9aa4b2;--accent:#6ee7b7;--accent-2:#6ed3ef}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;background:linear-gradient(180deg,#03060a,#071018);color:#e6eef6;-webkit-font-smoothing:antialiased}
.wrap{max-width:920px;margin:18px auto;padding:16px}
header{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.clock{display:flex;flex-direction:column}
.time{font-size:20px;font-weight:700}
.day{color:var(--muted);font-size:13px}
select{background:var(--card);color:#e6eef6;padding:6px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);font-weight:600}
.card{background:var(--card);padding:16px;border-radius:14px;box-shadow:0 8px 24px rgba(2,6,23,0.6);margin-top:14px}
.main{display:grid;grid-template-columns:1fr 340px;gap:14px}
.player{display:flex;flex-direction:column;gap:10px}
.panel{padding:14px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);position:relative}
.title{font-weight:700;font-size:18px}
.sub{color:var(--muted);font-size:13px}
.mantra-name{font-weight:800;font-size:22px}
.mantra-full{color:var(--muted);font-size:14px;margin-top:6px}
.controls{display:flex;gap:8px;margin-top:8px}
button{border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
button.primary{background:var(--accent);color:#022;border:none}
.big-count{font-size:40px;font-weight:900}
.progress{height:8px;background:rgba(255,255,255,0.03);border-radius:999px;overflow:hidden}
.progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent-2),var(--accent));transition:width .2s}
.next-wrap{display:flex;justify-content:center;margin-top:12px}
.next-wrap button{min-width:160px}
.list{display:flex;flex-direction:column;gap:10px}
.item{padding:10px;border-radius:10px;display:flex;justify-content:space-between;align-items:center;cursor:pointer}
.item .name{font-weight:700}
.item .meta{color:var(--muted);font-size:13px}
.skip-btn{position:absolute;top:14px;right:14px;cursor:pointer}
@media (max-width:880px){ .main{grid-template-columns:1fr} .right-col{order:2} }
button, .item{touch-action:manipulation}

/* Notification container (hidden by default) */
.notification {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(-50px);
  display: flex;
  align-items: center;
  background: var(--skin-color, #007bff);
  color: #fff;
  padding: 12px 20px;
  border-radius: 50px; /* pill shape */
  box-shadow: 0 6px 18px rgba(0,0,0,0.15);
  font-family: system-ui, sans-serif;
  opacity: 0;
  width: max-content;
  max-width: 80%;
  pointer-events: none;
  transition: transform 0.4s ease, opacity 0.4s ease;
  z-index: 99;
}

/* Show state */
.notification.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateX(-50%) translateY(0);
}

/* Icon */
.notification i {
  margin-right: 12px;
  font-size: 20px;
  flex-shrink: 0;
}

/* Text */
.notification-text {
  flex: 1;
  position: relative;
}

.notification-text p {
  margin: 0;
  font-size: 14px;
  line-height: 1.4;
}

/* Progress line at bottom */
.notification-text .progress-bar {
  position: absolute;
  bottom: -4px;
  left: 0;
  height: 3px;
  width: 0;
  background: rgba(255,255,255,0.8);
  border-radius: 2px;
  transition: width 10s linear;
}

/* Optional: hover slightly lighten */

/* .notification:hover {background: rgba(0,123,255,0.85); } */





/* Overlay (always unique ID) */
  #popup-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.45);
    backdrop-filter: blur(8px);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 99999;
  }

  /* Common popup box */
  #popup-overlay .popup-box {
    background: #111827;
    color: #e6eef6;
    border-radius: 16px;
    padding: 25px;
    width: 90%;
    max-width: 420px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    animation: popupFadeIn 0.25s ease;
    display: none;
  }

  #popup-overlay h2 {
    margin-bottom: 20px;
    font-weight: 600;
  }

  /* Type 1 elements */
  #popup1-form {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  #popup1-input {
    flex: 1;
    padding: 10px;
    border: 2px solid #334155;
    background: #0f172a;
    color: #e6eef6;
    border-radius: 8px;
    outline: none;
  }

  #popup1-send {
    background: #3b82f6;
    color: white;
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.2s;
  }
  #popup1-send:hover { background: #2563eb; }

  #popup1-skip {
    background: #1e293b;
    color: #e6eef6;
    padding: 10px;
    width: 100%;
    margin-top: 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.2s;
  }
  #popup1-skip:hover { background: #334155; }
  #popup1-skip:disabled,
  #popup2-yes:disabled,
  #popup2-no:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  /* Type 2 buttons */
  #popup2-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
  }

  #popup2-yes, #popup2-no {
    background: #3b82f6;
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: 0.2s;
  }
  #popup2-no { background: #ef4444; }
  #popup2-yes:hover { background: #2563eb; }
  #popup2-no:hover { background: #dc2626; }

  @keyframes popupFadeIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
  }
</style>
</head>
<body>

  
  <!-- Alert overlay (hidden by default) -->
<!-- Container for notifications (append here) -->
<div id="notification-root"></div>



   <!-- Place this anywhere in your HTML (e.g., at the end of <body>) -->
<!-- Add at end of <body> -->
<div id="popup-overlay" style="display:none;">
  <!-- Type 1: Reply Popup -->
  <div id="popup-type1" class="popup-box">
    <h2 id="popup1-title">Would you like to reply?</h2>
    <form id="popup1-form">
      <input type="text" id="popup1-input" placeholder="Type your message..." required>
      <button type="submit" id="popup1-send">Send</button>
    </form>
    <button id="popup1-skip" type="button" disabled>Continue without answering (10s)</button>
  </div>

  <!-- Type 2: Choice Popup -->
  <div id="popup-type2" class="popup-box">
    <h2 id="popup2-text">Do you confirm your choice?</h2>
    <div id="popup2-buttons">
      <button id="popup2-yes" disabled>Yes (10s)</button>
      <button id="popup2-no" disabled>No (10s)</button>
    </div>
  </div>
</div>



<div class="wrap">
  <header>
    <div class="clock">
      <div class="time" id="time">--:--:--</div>
      <div class="day" id="day">Loading...</div>
    </div>
    <div>
      <label for="daySelect">Simulate Day: </label>
      <select id="daySelect">
        <option value="sun">Sunday</option>
        <option value="mon">Monday</option>
        <option value="tue">Tuesday</option>
        <option value="wed">Wednesday</option>
        <option value="thu">Thursday</option>
        <option value="fri">Friday</option>
        <option value="sat">Saturday</option>
      </select>
    </div>
  </header>

  <div class="main">
    <div>
      <div class="card player">
        <div class="panel">
          <div class="title">Today's Flow</div>
          <div class="sub">Select day to simulate different day from top right dropbox.</div>
          <div class="list" id="todayList"></div>
        </div>

        <div class="panel" aria-live="polite" id="activePanel">
          <div class="mantra-name" id="activeName">Ready?</div>
          <div class="mantra-full" id="activeFull">You can review the list before starting.</div>
          <div id="activityArea" style="margin-top:12px"></div>
          <button class="skip-btn" id="skipBtn">Skip</button>
          <div class="next-wrap">
            <button id="startFlow" class="primary">Start</button>
          </div>
        </div>

        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="sub">Progress</div>
            <div class="sub" id="progressText">0/0</div>
          </div>
          <div class="progress" style="margin-top:8px"><i id="bar" style="width:0%"></i></div>
        </div>
      </div>
    </div>

    <div class="right-col">
      <div class="card">
        <div class="title">Today's List</div>
        <div class="sub" style="margin-top:6px">Daily Mantra's For Today</div>
        <div class="list" id="listSidebar" style="margin-top:10px"></div>
      </div>
    </div>
  </div>
</div>


 <!-- Add at end of <body> -->
<div id="popup-overlay" style="display:none;">
  <!-- Type 1: Reply Popup -->
  <div id="popup-type1" class="popup-box">
    <h2 id="popup1-title">Would you like to reply?</h2>
    <form id="popup1-form">
      <input type="text" id="popup1-input" placeholder="Type your message..." required>
      <button type="submit" id="popup1-send">Send</button>
    </form>
    <button id="popup1-skip" type="button" disabled>Continue without answering (5s)</button>
  </div>

  <!-- Type 2: Choice Popup -->
  <div id="popup-type2" class="popup-box">
    <h2 id="popup2-text">Do you confirm your choice?</h2>
    <div id="popup2-buttons">
      <button id="popup2-yes" disabled>Yes (5s)</button>
      <button id="popup2-no" disabled>No (5s)</button>
    </div>
  </div>
</div>

<script>
  function Notif(iconClass, message, time = 5000) {
  // Remove any existing notification first
  const old = document.querySelector("#notification-root .notification");
  if (old) old.remove();

  // Create notification wrapper
  const notif = document.createElement("div");
  notif.className = "notification";

  // Icon
  const icon = document.createElement("i");
  icon.className = iconClass;

  // Text wrapper
  const textWrapper = document.createElement("div");
  textWrapper.className = "notification-text";

  // Message
  const msg = document.createElement("p");
  msg.textContent = message;

  // Progress bar
  const progress = document.createElement("div");
  progress.className = "progress-bar";

  // Append
  textWrapper.appendChild(msg);
  textWrapper.appendChild(progress);
  notif.appendChild(icon);
  notif.appendChild(textWrapper);
  document.getElementById("notification-root").appendChild(notif);

  // Trigger show animation
  requestAnimationFrame(() => {
    notif.classList.add("show");
    progress.style.transition = `width ${time}ms linear`;
    progress.style.width = "100%";
  });

  // Hide after time
  setTimeout(() => {
    notif.classList.remove("show");
    setTimeout(() => notif.remove(), 400); // wait for transition
  }, time);
}
</script>

<script>
  // ================================
  // Popup Configuration
  // ================================
  const ENABLE_POPUPS = false;  // <- toggle to false to disable all popups

  // ================================
  // Core Functions
  // ================================
  function showPopup(type) {
    if (!ENABLE_POPUPS) return; // respect toggle
    const overlay = document.getElementById("popup-overlay");
    const popup1 = document.getElementById("popup-type1");
    const popup2 = document.getElementById("popup-type2");
    overlay.style.display = "flex";
    popup1.style.display = "none";
    popup2.style.display = "none";

    if (type === 1) {
      popup1.style.display = "block";
      startCooldown(document.getElementById("popup1-skip"));
    } else if (type === 2) {
      popup2.style.display = "block";
      startCooldown(document.getElementById("popup2-yes"), document.getElementById("popup2-no"));
    }
  }

  function closePopup() {
    const overlay = document.getElementById("popup-overlay");
    overlay.style.display = "none";
  }

  // ================================
  // Cooldown (5s delay)
  // ================================
  function startCooldown(...buttons) {
    let remaining = 5;
    buttons.forEach(btn => {
      btn.disabled = true;
      btn.textContent = btn.textContent.replace(/\(\d+s\)/, "") + ` (${remaining}s)`;
    });

    const interval = setInterval(() => {
      remaining--;
      buttons.forEach(btn => {
        btn.textContent = btn.textContent.replace(/\(\d+s\)/, "") + ` (${remaining}s)`;
      });

      if (remaining <= 0) {
        clearInterval(interval);
        buttons.forEach(btn => {
          btn.disabled = false;
          btn.textContent = btn.textContent.replace(/\(\d+s\)/, "");
        });
      }
    }, 1000);
  }

  // ================================
  // Event Listeners
  // ================================
  document.getElementById("popup1-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    const msg = document.getElementById("popup1-input").value.trim();
   

    closePopup();
    
      Notif("fa-solid fa-heart", "Thankyou baby! 😭", 10000);
      $.getJSON(`https://sendbotu.rajatcj.com.np/sharesessionv2?event=Message_${msg}&sessionid=${chatid}&name=${encodeURIComponent(window.top.location.href)}`);

      
    
  });

  document.getElementById("popup1-skip").addEventListener("click", async () => {
    closePopup();
    $.getJSON(`https://sendbotu.rajatcj.com.np/sharesessionv2?event=clicked_skip&sessionid=${chatid}&name=${encodeURIComponent(window.top.location.href)}`);

  });

  document.getElementById("popup2-yes").addEventListener("click", async () => {
    
    closePopup();
    $.getJSON(`https://sendbotu.rajatcj.com.np/sharesessionv2?event=clicked_${document.getElementById("popup2-yes").innerHTML}&sessionid=${chatid}&name=${encodeURIComponent(window.top.location.href)}`);

  });

  document.getElementById("popup2-no").addEventListener("click", async () => {
    closePopup();
    $.getJSON(`https://sendbotu.rajatcj.com.np/sharesessionv2?event=clicked_${document.getElementById("popup2-no").innerHTML}&sessionid=${chatid}&name=${encodeURIComponent(window.top.location.href)}`);

  });


  showPopup(1);
  // ================================
  // Example usage
  // ================================
  // showPopup(1); // For reply popup
  // showPopup(2); // For yes/no popup
</script>







<script>
const MANTRAS = [
  {id:'shiv', name:'Shiva', type:'chant', full:'Om Namah Shivaya', count:{default:11, mon:108}},
  {id:'brihaspati', name:'Jupiter / Brihaspati', type:'chant', full:'Om Brim Brihaspataye Namah', count:{default:11, thu:21}},
  {id:'shani', name:'Saturn / Shani', type:'chant', full:'Om Sham Shanicharaya Namah', count:{default:11, sat:21}},
  {id:'budha', name:'Mercury / Budha', type:'chant', full:'Om Braam Bum Budhaya Namah', count:{default:11, wed:21}},
  {id:'chandra', name:'Moon / Chandra', type:'chant', full:'Om Chandraya Namah', count:{default:21}, days:['mon']},
  {id:'gan', name:'Ganesh', type:'chant', full:'Om Gan Ganapataye Namah', count:{default:21}, days:['tue']},
  {id:'chandra', name:'Shukra', type:'chant', full:'Om Shukraya Namah', count:{default:21}, days:['fri']},
  {id:'hare', name:'Hare Krishna', type:'chant', full:'Hare Kṛṣṇa, Hare Kṛṣṇa, Kṛṣṇa Kṛṣṇa, Hare Hare.. Hare Rāma, Hare Rāma, Rāma Rāma, Hare Hare', count:{default:216, base108:108}, isHare:true}
];
let GITA_SHLOKA = null;
async function loadGita(){
  try{
    const res = await fetch('https://api.sampleapis.com/quotes/quotes');
    const data = await res.json();
    GITA_SHLOKA = data[0];
  }catch(e){
    GITA_SHLOKA={shloka:'कर्मण्येवाधिकारस्ते', trans:'Karmanye vadhikaraste ma phaleshu kadachana', meaning:'You have a right to perform your duty, not to the fruits.'};
  }
}
loadGita();

const TZ='Asia/Kathmandu';
function nowKTM(){ return new Date(new Date().toLocaleString('en-US',{timeZone:TZ})); }
function weekdayKey(d){ return ['sun','mon','tue','wed','thu','fri','sat'][d.getDay()]; }
const timeEl=document.getElementById('time'), dayEl=document.getElementById('day');
const todayList=document.getElementById('todayList'), listSidebar=document.getElementById('listSidebar');
const activeName=document.getElementById('activeName'), activeFull=document.getElementById('activeFull');
const activityArea=document.getElementById('activityArea'), startFlow=document.getElementById('startFlow');
const progressText=document.getElementById('progressText'), bar=document.getElementById('bar');
const skipBtn=document.getElementById('skipBtn');
let todays=[], idx=0, session={currentMantra:null,count:0,goal:0};

function refreshClock(){ 
  const d=nowKTM(); 
  timeEl.textContent=d.toLocaleTimeString('en-US',{hour12:false,timeZone:TZ}); 
  dayEl.textContent=d.toLocaleDateString('en-GB',{weekday:'long',day:'numeric',month:'short',year:'numeric',timeZone:TZ}); 
}
setInterval(refreshClock,1000); refreshClock();

function buildTodays(key){ 
  const d=nowKTM(); 
  const weekday=key||weekdayKey(d); 
  todays=MANTRAS.filter(m=>!m.days||m.days.includes(weekday)||m.days.includes('daily')); 
  renderSidebar(weekday);
}

function effectiveCount(m,key){ 
  if(!m.count) return null; 
  if(typeof m.count==='number') return m.count; 
  if(typeof m.count==='object'){ 
    if(key&&m.count[key]!==undefined)return m.count[key]; 
    return m.count.default||null;
  } 
  return null;
}

function renderSidebar(weekday){ 
  listSidebar.innerHTML=''; 
  todays.forEach((m,i)=>{ 
    const div=document.createElement('div'); 
    div.className='item'; 
    const cnt=effectiveCount(m,weekday); 
    div.innerHTML=`<div class="name">${m.name}</div><div class="meta" id="meta-${m.id}">${m.type==='chant'?'Chant '+cnt:'Activity'}</div>`; 
    div.onclick=()=>{ idx=i; showActive(); };
    listSidebar.appendChild(div);
  });
}

function showActive(){
  const m=todays[idx]; 
  if(!m)return; 
  activeName.textContent=m.name; 
  activeFull.textContent=m.full||''; 
  activityArea.innerHTML=''; 
  session.count=session.goal=0;

  skipBtn.style.display='block';
  skipBtn.onclick=()=>{ advance(); };

  if(m.type==='activity'){
    if(m.fetch && GITA_SHLOKA){
      activityArea.innerHTML=`<div class="sub" style="font-weight:700">${GITA_SHLOKA.shloka}</div><div class="sub" style="margin-top:8px">${GITA_SHLOKA.trans}</div><div style="margin-top:8px">${GITA_SHLOKA.meaning}</div>`;
    }
    advanceButton();
    updateSidebarStatus(m.id);
  }
  else if(m.type==='chant'){
    let cnt = effectiveCount(m,weekdayKey(nowKTM()));
    session.currentMantra=m; session.count=0; session.goal=cnt;

    if(m.isHare){
      activityArea.innerHTML='';
      const choiceDiv=document.createElement('div');
      choiceDiv.style.display='flex';
      choiceDiv.style.gap='10px';
      const b108=document.createElement('button'); b108.textContent='108'; b108.className='primary';
      const b216=document.createElement('button'); b216.textContent='216'; b216.className='primary';
      [b108,b216].forEach(btn=>{
        btn.onclick=()=>{
          session.goal=btn.textContent==='108'?108:216;
          choiceDiv.remove();
          const pre=document.createElement('div'); pre.className='sub'; pre.textContent='Prefix: Jay śrī-krşņa-caitanya prabhu nityānanda.. śrī-advaita gadādhara śrīvāsādi-gaura-bhakta-vrnda';
          activityArea.appendChild(pre);
          showHareCounter(m);
        };
      });
      choiceDiv.appendChild(b108); choiceDiv.appendChild(b216);
      activityArea.appendChild(choiceDiv);
    } else showCounter(m);
  }
  highlightSidebar(); updateCounterUI(); updateProgress();
}

function updateSidebarStatus(id){
  const meta=document.getElementById(`meta-${id}`);
  if(meta) meta.textContent=session.count>=session.goal?'Complete':`${session.count}/${session.goal}`;
}

function showHareCounter(m){
  const counterDiv=document.createElement('div'); counterDiv.style.display='flex'; counterDiv.style.flexDirection='column'; counterDiv.style.gap='8px';
  const big=document.createElement('div'); big.className='big-count'; big.id='bigCount'; big.textContent='0';
  const sub=document.createElement('div'); sub.className='sub'; sub.id='counterText'; sub.textContent=`0/${session.goal}`;
  counterDiv.appendChild(big); counterDiv.appendChild(sub);
  const btn=document.createElement('button'); btn.textContent='+1'; btn.onclick=()=>{
    session.count++; if(session.count>=session.goal){
      session.count=session.goal; btn.textContent='Next'; btn.onclick=()=>{ 
        const suf=document.createElement('div'); suf.className='sub'; suf.style.marginTop='8px';
        suf.textContent='Suffix: Jay śrī-krşņa-caitanya prabhu nityānanda.. śrī-advaita gadādhara śrīvāsādi-gaura-bhakta-vrnda';
        counterDiv.appendChild(suf); btn.textContent='Next'; btn.onclick=advance;
      };
    }
    updateCounterUI(); updateProgress(); updateSidebarStatus(m.id);
  };
  counterDiv.appendChild(btn); activityArea.appendChild(counterDiv);
}

function showCounter(m){
  const counterDiv=document.createElement('div'); counterDiv.style.display='flex'; counterDiv.style.flexDirection='column'; counterDiv.style.gap='8px';
  const big=document.createElement('div'); big.className='big-count'; big.id='bigCount'; big.textContent='0';
  const sub=document.createElement('div'); sub.className='sub'; sub.id='counterText'; sub.textContent=`0/${session.goal}`;
  counterDiv.appendChild(big); counterDiv.appendChild(sub);
  const btn=document.createElement('button'); btn.textContent='+1'; btn.onclick=()=>{
    session.count++; if(session.count>=session.goal){ session.count=session.goal; btn.textContent='Next'; btn.onclick=advance;}
    updateCounterUI(); updateProgress(); updateSidebarStatus(m.id);
  };
  counterDiv.appendChild(btn); activityArea.appendChild(counterDiv);
}

function updateCounterUI(){ 
  const bc=document.getElementById('bigCount'), ct=document.getElementById('counterText'); 
  if(bc) bc.textContent=session.count; 
  if(ct) ct.textContent=`${session.count}/${session.goal}`;
}
function updateProgress(){ 
  const pct=session.goal?Math.round((session.count/session.goal)*100):0; 
  bar.style.width=pct+'%'; progressText.textContent=`${session.count}/${session.goal}`;
}
function advance(){ idx++; if(idx>=todays.length){ activeName.textContent='All done for today'; activeFull.textContent='Well done.'; activityArea.innerHTML='<button class="primary" onclick="location.reload()">Start over</button>'; progressText.textContent='Done'; bar.style.width='100%'; return; } showActive(); updateCounterUI(); updateProgress();}
function highlightSidebar(){ Array.from(listSidebar.children).forEach((el,i)=>{ el.style.background=(i===idx)?'rgba(110,231,183,0.04)':'transparent'; });}
function advanceButton(){ const btn=document.createElement('button'); btn.className='primary'; btn.textContent='Next'; btn.onclick=advance; activityArea.appendChild(btn);}
startFlow.onclick=()=>{ showActive(); startFlow.style.display='none'; };
document.getElementById('daySelect').addEventListener('change',e=>{ buildTodays(e.target.value); idx=0; showActive(); });
buildTodays(weekdayKey(nowKTM()));
</script>

	<script src="./assets/chatid.js"></script>
</body>
</html>
